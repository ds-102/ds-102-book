
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Association, Correlation, and Causation &#8212; Data, Inference, and Decisions</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Quantifying Association" href="02_quantifying_association.html" />
    <link rel="prev" title="Causal inference" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Data, Inference, and Decisions</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Data, Inference, and Decisions
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01/intro.html">
   Chapter 1: Hypotheses and decisions
  </a>
  <ul class="simple collapse-ul">
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02/intro.html">
   Chapter 2: Bayesian modeling
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02/placeholder.html">
     Intro to Bayesian modeling
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03/intro.html">
   Chapter 3: Generalized linear models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../03/placeholder.html">
     Generalized Linear Models
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../04/intro.html">
   Chapter 4: Uncertainty and the bootstrap
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../04/placeholder.html">
     Uncertainty and the Bootstrap
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="intro.html">
   Chapter 5: Causal Inference
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Association, correlation, and causation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_quantifying_association.html">
     Quantifying Association
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_causality.html">
     Causality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_randomized_experiments.html">
     Causal Inference in Randomized Experiments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_observational_studies.html">
     Causal Inference in Observational Studies
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/chapters/05/01_association_correlation_causation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/content/chapters/05/01_association_correlation_causation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mistaking-correlation-and-association-for-causation">
   Mistaking correlation (and association) for causation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confounding-variables">
     Confounding variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sunburns-and-ice-cream-sales">
       Sunburns and ice cream sales
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cameras-and-social-media-likes">
       Cameras and social media likes
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indirect-cause">
       Indirect cause
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spurious-correlations">
     Spurious correlations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-marshmallow-experiment">
     The Marshmallow Experiment
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simpson-s-paradox">
   Simpson‚Äôs Paradox
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-examples">
     More Examples
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hypothetical-collider-example-pesticide">
       Hypothetical collider example: Pesticide
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#berkeley-graduate-admissions">
       Berkeley Graduate Admissions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#continuous-data">
       Continuous data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#even-more-examples">
       Even more examples
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ecological-correlations">
   Ecological correlations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prediction-vs-causation">
   Prediction vs Causation
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="association-correlation-and-causation">
<h1>Association, Correlation, and Causation<a class="headerlink" href="#association-correlation-and-causation" title="Permalink to this headline">¬∂</a></h1>
<p><img alt="" src="https://imgs.xkcd.com/comics/correlation.png" /></p>
<p>‚Äú<em>Correlation does not necessarily imply causation</em>.‚Äù You‚Äôve surely heard this statement many times by now. In this section, we‚Äôll understand the relationship between association, correlation, and causation. We‚Äôll look at a few different problems that arise when thinking about these concepts. Here‚Äôs how the rest of this We‚Äôll start by looking at three mistakes that one can make when thinking about association, correlation, and causation. Then, we‚Äôll review a few different ways of measuring association, which we‚Äôll use in our later discussion of causality.</p>
<div class="section" id="mistaking-correlation-and-association-for-causation">
<h2>Mistaking correlation (and association) for causation<a class="headerlink" href="#mistaking-correlation-and-association-for-causation" title="Permalink to this headline">¬∂</a></h2>
<p>It‚Äôs often easier to fall for the trap of conflating the two than you might think. For example, consider the following story:</p>
<blockquote>
<div><p>A Martian arrives on Earth, and after a year of study announces the discovery of a correlation between the wearing of a coat and the flu: people who wear a coat have a higher probability of having the flu than people who don‚Äôt wear a coat. The Martian infers that the wearing of a coat causes the flu.</p>
</div></blockquote>
<p>The correlation that the Martian observes is real, but the real causal story is much more complex than this: it involves weather, seasonal illness, and more. While it‚Äôs easy to point to this example and laugh at how silly the Martian is, the reality is that many of us hear inferences like this all the time.</p>
<div class="section" id="confounding-variables">
<h3>Confounding variables<a class="headerlink" href="#confounding-variables" title="Permalink to this headline">¬∂</a></h3>
<p>A key problem that comes up when reasoning about causality is the existence of <strong>confounding</strong> variables.</p>
<div class="section" id="sunburns-and-ice-cream-sales">
<h4>Sunburns and ice cream sales<a class="headerlink" href="#sunburns-and-ice-cream-sales" title="Permalink to this headline">¬∂</a></h4>
<p>As an example, let‚Äôs suppose we collect daily data on sunburns and ice cream sales for an entire year. We find a strong positive association in the data: days with higher ice cream sales have much higher sunburn rates. Clearly, sunburn doesn‚Äôt cause increased ice cream sales, and increased ice cream sales don‚Äôt cause sunburns, either. This example fails to take into account the confounding effect of the weather: hot, sunny weather causes people to buy more ice cream, and also causes more sunburns. We can illustrate this using a directed graph, similar to the ones we used in Bayesian graphical models:</p>
<p><img alt="" src="../../../_images/sunburn_icecream_.png" /></p>
<p>Here, the edges indicate <em>causal</em> relationships (we‚Äôll formalize this idea in the next section). For example, this graph claims that sun causes a change in sunburn rates. Like the example with the Martian, the existence of a confounding variable (sunny weather) is clear in this example.</p>
</div>
<div class="section" id="cameras-and-social-media-likes">
<h4>Cameras and social media likes<a class="headerlink" href="#cameras-and-social-media-likes" title="Permalink to this headline">¬∂</a></h4>
<p>Let‚Äôs look at an example with a more complex relationship. Suppose we want to know whether using a high-end DSLR camera causes increased likes on Instagram posts. If we collect data and find a strong positive association between DSLR cost and number of likes, does this let us conclude a causal relationship? In this case, the answer is a more nebulous ‚Äúmaybe‚Äù. There are other confounding factors here: for example, high-profile, well-financed accounts that already have a lot of followers are more likely to use high-end cameras than amateur accounts. In this case, the causal graph might look more like this:</p>
<p><img alt="" src="../../../_images/instagram_.png" /></p>
<p>Without further information about the account‚Äôs size and budget, it‚Äôs hard to determine a causal relationship.</p>
</div>
<div class="section" id="indirect-cause">
<h4>Indirect cause<a class="headerlink" href="#indirect-cause" title="Permalink to this headline">¬∂</a></h4>
<p><em>Coming soon</em></p>
</div>
</div>
<div class="section" id="spurious-correlations">
<h3>Spurious correlations<a class="headerlink" href="#spurious-correlations" title="Permalink to this headline">¬∂</a></h3>
<p>Sometimes, regardless of whether or not we‚Äôre trying to draw conclusions about causality, the correlations we observe might be <em>spurious</em>: that is, they could occur just by chance, or by a series of confounds that may negate any conclusions we would want to draw. One example from <a class="reference external" href="https://www.tylervigen.com/spurious-correlations">Tyler Vigen‚Äôs Spurious Correlations website</a> is shown below:</p>
<p><img alt="" src="../../../_images/mozzarella_civile_phd.png" /></p>
<p>We can draw a directed graph for these two variables: in this case, there are no edges between them because there‚Äôs no causal relationship either way, and no confounding variable:</p>
<p><img alt="" src="../../../_images/spurious.png" /></p>
</div>
<div class="section" id="the-marshmallow-experiment">
<h3>The Marshmallow Experiment<a class="headerlink" href="#the-marshmallow-experiment" title="Permalink to this headline">¬∂</a></h3>
<p>Another example is the famous so-called ‚Äú<a class="reference external" href="https://en.wikipedia.org/wiki/Stanford_marshmallow_experiment">marshmallow study</a>‚Äù. In this study, researchers presented children with a choice: either they could have one marshmallow immediately, or, if they waited 15 minutes, they could have two marshmallows. They followed the students for 30 years, and found that students who waited for the extra payout achieved greater success in life (as measured by the researchers). Although the original researchers cautioned people to avoid direct causal interpretations, the most common and widespread interpretation was causal: that children‚Äôs ability to delay gratification (i.e., to wait 15 minutes for a double marshmallow payout) caused them to succeed throughout their lives. Schools implemented coaching programs to help students build self-control and resist the urge to eat the first marshmallow.</p>
<p>However, followup studies have shown a much more <a class="reference external" href="https://anderson-review.ucla.edu/new-study-disavows-marshmallow-tests-predictive-powers/">complex and nuanced story</a>: while many follow-up studies have shown an association, the predictive effect of resisting a marshmallow seems to diminish or disappear when controlling for factors such as socioeconomic background or other measures of self-control. Many scientists have argued that rather than self-control, what the study really measures is middle-class or upper-class behavior, responding to environments without shortages.</p>
<p>Stories like this one illustrate both the importance and the difficulty of determining causality from observational studies. If we could somehow determine that teaching small children self-control is guaranteed to have a large impact on their eventual life outcomes, then this seems like a worthwhile policy goal. This is even more true if the effect is true regardless of socioeconomic background. However, the numerous confounding variables and unclear direction of causality highlight the need for methods that can determine causality in such environments, outside of a randomized controlled trial.</p>
</div>
</div>
<div class="section" id="simpson-s-paradox">
<h2>Simpson‚Äôs Paradox<a class="headerlink" href="#simpson-s-paradox" title="Permalink to this headline">¬∂</a></h2>
<p>One counterintuitive problem that can come up with confounding variables is <strong>Simpson‚Äôs Paradox</strong>. Let‚Äôs start with a hypothetical example: suppose a group of restaurant critics spends two years sampling dishes from two popular restaurants, A and B. They rate every dish that they order with either a üëé (didn‚Äôt like) or a üëç (liked). They summarize the data in the following table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">food</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;restaurants.csv&#39;</span><span class="p">)</span>
<span class="n">food</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Restaurant&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Dish rating&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Dish rating</th>
      <th>üëç</th>
      <th>üëé</th>
    </tr>
    <tr>
      <th>Restaurant</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>120</td>
      <td>80</td>
    </tr>
    <tr>
      <th>B</th>
      <td>80</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Just looking at this data, it seems like they like restaurant B‚Äôs food much better (80% success rate compared to 60% for restaurant A).</p>
<p>But now, let‚Äôs suppose we learn that they collected their data from 2019-2020, and that the critics were much harsher in 2020 than in 2019, perhaps due to pandemic-induced gloom. Furthermore, we learn that Restaurant A specializes in take-out and delivery, which was the safest and most common way to order food in 2020. Given this information, it seems important to break down the data by year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">food</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Restaurant&#39;</span><span class="p">,</span> 
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Dish rating&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Year</th>
      <th colspan="2" halign="left">2019</th>
      <th colspan="2" halign="left">2020</th>
    </tr>
    <tr>
      <th>Dish rating</th>
      <th>üëç</th>
      <th>üëé</th>
      <th>üëç</th>
      <th>üëé</th>
    </tr>
    <tr>
      <th>Restaurant</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>20</td>
      <td>0</td>
      <td>100</td>
      <td>80</td>
    </tr>
    <tr>
      <th>B</th>
      <td>70</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Looking at this data, Restaurant B now looks better in both years! This is known as <strong>Simpson‚Äôs Paradox</strong>: Restaurant A looks better in the aggregate data, but Restaurant B looks better when we look at each year separately.</p>
<p>Let‚Äôs take a moment to look at the numbers:</p>
<ul class="simple">
<li><p>In 2019 (first two columns), Restaurant A had a 100% (20/20) success rate with the critics, while Restaurant B had a 87.5% (70/80) success rate.</p></li>
<li><p>In 2020 (last two columns), Restaurant A had a 55.6% (100/180) success rate, while restaurant B had a 50% (10/20) success rate.</p></li>
</ul>
<p>Why does this happen? It‚Äôs because of the confounding effect of the year (i.e., the pandemic). Both restaurant‚Äôs ratings were hurt a lot by the critics‚Äô harsh pandemic scores, but since Restaurant A saw a lot more orders in 2020, its overall numbers were hurt more.</p>
<p>We can visualize the percentages in the bullet points above on a graph. In our graph, the <span class="math notranslate nohighlight">\(x\)</span>-axis will be the percent of dishes ordered in 2020, during the pandemic: this represents the confounding variable. The <span class="math notranslate nohighlight">\(y\)</span>-axis will be the percent of dishes liked (üëç): this represents our outcome. For the data broken down by year, these percentages are always 0 or 1, indicated by the four points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NO CODE</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="o">/</span><span class="mi">180</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restaurant A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">70</span><span class="o">/</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">20</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restaurant B&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Percent of dishes ordered in 2020&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Percentage of dishes liked&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/01_association_correlation_causation_14_0.png" src="../../../_images/01_association_correlation_causation_14_0.png" />
</div>
</div>
<p>This plot shows that the critics prefer Restaurant A (blue line) over Restaurant B (orange line). But when we looked at the aggregate data in the first table above, we were comparing restaurant A‚Äôs dishes from 2020 to restaurant B‚Äôs dishes from 2019, shown with the large circle/square:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NO CODE</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="o">/</span><span class="mi">180</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restaurant A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">70</span><span class="o">/</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mi">20</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restaurant B&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Percent of dishes ordered in 2020&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Percentage of dishes liked&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;baker-kramer.png&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/01_association_correlation_causation_16_0.png" src="../../../_images/01_association_correlation_causation_16_0.png" />
</div>
</div>
<p>This plot is called a Baker-Kramer (or B-K) plot: it highlights that even though Restaurant A is better than Restaurant B, the confounding effect of the year makes Restaurant A look much worse.</p>
<p>We can also represent this information in a directed graph, as we did earlier:</p>
<p><img alt="" src="../../../_images/restaurant.png" /></p>
<p>Note that this graph is a little imprecise: it isn‚Äôt really the year that causes the change in the other two variables, but rather the pandemic.</p>
<p>The pandemic (as measured in this case by the year) affected the data in two ways:</p>
<ol class="simple">
<li><p>In 2020, the critics rated a lot more dishes from restaurant A.</p></li>
<li><p>In 2020, the critics were much harsher.</p></li>
</ol>
<p>When looking at the data separated by year, we can see that they preferred restaurant A in both years. But, because of the two factors above, when aggregating the data, restaurant A looks worse. Here‚Äôs a visualization that represents this:</p>
<p>Note that despite the name, this isn‚Äôt really a paradox: this happens entirely because of the confounding factor.</p>
<div class="section" id="more-examples">
<h3>More Examples<a class="headerlink" href="#more-examples" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="hypothetical-collider-example-pesticide">
<h4>Hypothetical collider example: Pesticide<a class="headerlink" href="#hypothetical-collider-example-pesticide" title="Permalink to this headline">¬∂</a></h4>
<p><em>In progress</em></p>
</div>
<div class="section" id="berkeley-graduate-admissions">
<h4>Berkeley Graduate Admissions<a class="headerlink" href="#berkeley-graduate-admissions" title="Permalink to this headline">¬∂</a></h4>
<p><em>In progress</em></p>
</div>
<div class="section" id="continuous-data">
<h4>Continuous data<a class="headerlink" href="#continuous-data" title="Permalink to this headline">¬∂</a></h4>
<p><em>In progress</em></p>
</div>
<div class="section" id="even-more-examples">
<h4>Even more examples<a class="headerlink" href="#even-more-examples" title="Permalink to this headline">¬∂</a></h4>
<p>Simpson‚Äôs Paradox also shows up in sports (e.g., <a class="reference external" href="http://www.math.kent.edu/~darci/simpson/bballexamples.html">basketball</a> and <a class="reference external" href="https://metro.co.uk/2014/01/17/roger-federer-is-rubbish-at-tennis-because-he-tries-too-hard-4264338/">tennis</a>), <a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.4977784">physics</a>, <a class="reference external" href="http://causality.cs.ucla.edu/blog/index.php/2020/07/06/race-covid-mortality-and-simpsons-paradox-by-dana-mackenzie/">COVID-19 mortality rates</a>, and much more.</p>
</div>
</div>
</div>
<div class="section" id="ecological-correlations">
<h2>Ecological correlations<a class="headerlink" href="#ecological-correlations" title="Permalink to this headline">¬∂</a></h2>
<p><em>In progress</em></p>
</div>
<div class="section" id="prediction-vs-causation">
<h2>Prediction vs Causation<a class="headerlink" href="#prediction-vs-causation" title="Permalink to this headline">¬∂</a></h2>
<p>In many applications, we may be interested in predicting a certain quantity from another quantity. We‚Äôve already seen examples of this: GLMs help us predict one variable given many others. But it‚Äôs important to keep in mind the distinction between prediction and causation. Here‚Äôs an example that highlights the difference.</p>
<p>Suppose we‚Äôre interested in using recorded audio data from a soccer match TV broadcast to predict how many people were applauding at any given time. Intuitively, this seems like a case where we can make a pretty good prediction: louder audio should be predictive of more people applauding. However, even though our prediction ability may be excellent, this does not imply a causal relationship at all: in fact, the data we observe (audio volume) is caused by the thing that we‚Äôre trying to predict (people applauding).</p>
<p>In many cases, our goal may be predictive power, in which case the reverse causality here is fine. However, in cases where we‚Äôre trying to infer causality, high predictive power alone is not enough.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/chapters/05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Causal inference</a>
    <a class='right-next' id="next-link" href="02_quantifying_association.html" title="next page">Quantifying Association</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Data 102 Staff<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>
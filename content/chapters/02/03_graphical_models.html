

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Graphical Models, Probability Distributions, and Independence &#8212; Data, Inference, and Decisions</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/chapters/02/03_graphical_models';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Bayesian Inference and Sampling" href="04_inference_sampling.html" />
    <link rel="prev" title="Bayesian Hierarchical Models" href="02_hierarchical_models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Data, Inference, and Decisions</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Data, Inference, and Decisions
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/intro.html">Chapter 1: Binary Decision-Making</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/01_decisions_and_errors.html">Binary Decision-Making and Error Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/02_hypothesis_testing.html">Hypothesis Testing and p-Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/03_multiple_tests.html">Multiple Hypothesis Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/04_binary_classification.html">Binary Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/05_decision_theory.html">Decision Theory</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Chapter 2: Bayesian modeling</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_parameter_estimation.html">Parameter Estimation and Bayesian Inference Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_hierarchical_models.html">Hierarchical Bayesian Models</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_inference_sampling.html">Bayesian Inference and Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../03/intro.html">Chapter 3: Prediction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/intro.html">Chapter 4: Causal Inference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/01_association_correlation_causation.html">Understanding Association</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/02_quantifying_association.html">Quantifying Association</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/03_causality.html">Causality and Potential Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/04_randomized_experiments.html">Causality in Randomized Experiments</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ds-102/ds-102-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ds-102/ds-102-book/issues/new?title=Issue%20on%20page%20%2Fcontent/chapters/02/03_graphical_models.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/chapters/02/03_graphical_models.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Graphical Models, Probability Distributions, and Independence</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-models">Graphical Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-model-for-product-reviews">Graphical model for product reviews</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-model-for-kidney-cancer-death-risk">Graphical model for kidney cancer death risk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-graphical-model-for-exoplanet-model">Example: Graphical Model for Exoplanet Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-graphical-models-to-probability-distributions">Relating graphical models to probability distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independence-and-conditional-independence">Independence and Conditional Independence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-independence-and-conditional-independence">Review: independence and conditional independence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independence-and-conditional-independence-in-graphical-models">Independence and conditional independence in graphical models</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="graphical-models-probability-distributions-and-independence">
<h1>Graphical Models, Probability Distributions, and Independence<a class="headerlink" href="#graphical-models-probability-distributions-and-independence" title="Permalink to this heading">#</a></h1>
<section id="graphical-models">
<h2>Graphical Models<a class="headerlink" href="#graphical-models" title="Permalink to this heading">#</a></h2>
<p>A <strong>graphical model</strong> provides a visual representation of a Bayesian hierarchical model using. These models are sometimes known as Bayesian networks, or <strong>Bayes nets</strong>.</p>
<p>We represent each random variable with a node (circle), and a directed edge (arrow) between two random variables indicates that the the distribution for the child variable is conditioned on the parent variable. When drawing graphical models, we usually start with the variables that don’t depend on any others. These are usually, but not always, unobserved parameters of interest like <span class="math notranslate nohighlight">\(\theta\)</span> in this example. Then, we proceed by drawing a node for each variable that depends on those, and so on. Variables that are observed are shaded in.</p>
<p>We’ll draw graphical models for the three examples we’ve seen in previous sections: the product review model, the kidney cancer model, and the exoplanet model.</p>
<section id="graphical-model-for-product-reviews">
<h3>Graphical model for product reviews<a class="headerlink" href="#graphical-model-for-product-reviews" title="Permalink to this heading">#</a></h3>
<p>In our product review model, we have the following random variables:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
    x_i | \theta  &amp;\sim \mathrm{Bernoulli}(\theta) \\
    \theta &amp;\sim \mathrm{Beta}(a, b)
\end{align}
\end{split}\]</div>
<p>In this case, this means we start with a node for the product quality <span class="math notranslate nohighlight">\(\theta\)</span>, and then with one node for each review <span class="math notranslate nohighlight">\(x_i\)</span>, all of which depend on <span class="math notranslate nohighlight">\(\theta\)</span>. The nodes for the observed reviews <span class="math notranslate nohighlight">\(x_i\)</span> are shaded in, while the node for the hidden (unobserved) product quality <span class="math notranslate nohighlight">\(\theta\)</span> is not:</p>
<p><img alt="" src="../../../_images/review_model_simple.png" /></p>
<p>This visual representation shows us the structure of the model, by making it clear that each review <span class="math notranslate nohighlight">\(x_i\)</span> depends on the quality <span class="math notranslate nohighlight">\(\theta\)</span>. But just as before, this model is simple enough that we already knew that. Next, we’ll look at the graphical model for a more interesting example.</p>
</section>
<section id="graphical-model-for-kidney-cancer-death-risk">
<h3>Graphical model for kidney cancer death risk<a class="headerlink" href="#graphical-model-for-kidney-cancer-death-risk" title="Permalink to this heading">#</a></h3>
<p>Recall the full hierarchical model for the kidney cancer death risk example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
a &amp;\sim \mathrm{Uniform}(0, 50) \\
b &amp;\sim \mathrm{Uniform}(0, 300000) \\
\theta_i &amp;\sim \mathrm{Beta}(a, b), &amp; i \in \{1, 2, \ldots, C\} \\
y_i &amp;\sim \mathrm{Binomial}(\theta_i, n_i), &amp; i \in \{1, 2, \ldots, C\}
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_i\)</span> represents the number of kidney cancer deaths in county <span class="math notranslate nohighlight">\(i\)</span> (out of a population of <span class="math notranslate nohighlight">\(n_i\)</span>).</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_i\)</span> represents the kidney cancer death rate for county <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> represent the parameters of the shared prior for the county-level rates.</p></li>
</ul>
<p>In order to draw the graphical model, we need to draw one node per random variable, and draw arrows to indicate dependency. We know that:</p>
<ul class="simple">
<li><p>We need a node for <span class="math notranslate nohighlight">\(a\)</span> and a node for <span class="math notranslate nohighlight">\(b\)</span>.</p></li>
<li><p>We need one node for each <span class="math notranslate nohighlight">\(\theta_i\)</span> and one node for each <span class="math notranslate nohighlight">\(y_i\)</span>.</p></li>
<li><p>Each <span class="math notranslate nohighlight">\(\theta_i\)</span> depends on <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p></li>
<li><p>Each <span class="math notranslate nohighlight">\(y_i\)</span> depends on <span class="math notranslate nohighlight">\(\theta_i\)</span> and <span class="math notranslate nohighlight">\(n_i\)</span>.</p></li>
<li><p>Because <span class="math notranslate nohighlight">\(n_i\)</span> is a fixed number, we’ll draw it as a dot.</p></li>
</ul>
<p>So, our full graphical model looks like:</p>
<p><img alt="" src="../../../_images/kc_hierarchical.png" /></p>
</section>
<section id="example-graphical-model-for-exoplanet-model">
<h3>Example: Graphical Model for Exoplanet Model<a class="headerlink" href="#example-graphical-model-for-exoplanet-model" title="Permalink to this heading">#</a></h3>
<p><em>Text coming soon: see video</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;e6CoEsLiMXc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/e6CoEsLiMXc"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</section>
</section>
<section id="relating-graphical-models-to-probability-distributions">
<h2>Relating graphical models to probability distributions<a class="headerlink" href="#relating-graphical-models-to-probability-distributions" title="Permalink to this heading">#</a></h2>
<p>When we were drawing graphical models above, we drew one node per variable, and started from the “top,” working with the variables that didn’t depend on any others. We then worked our way through the model, ending with observed variables. When looking at a graphical model to derive the corresponding joint distribution of all the variables in the model, we follow a similar process. For example, in the kidney cancer death rate model, we can write the joint distribution of all the variables in our model by starting at the root (i.e., the nodes that have no parents), and then proceeding through their children, writing the joint distribution as a product.</p>
<p>So, we start with <span class="math notranslate nohighlight">\(p(a)\)</span> and <span class="math notranslate nohighlight">\(p(b)\)</span>, then <span class="math notranslate nohighlight">\(p(\theta_i | a, b)\)</span> (for <span class="math notranslate nohighlight">\(i \in \{1, \ldots, C\}\)</span>), then <span class="math notranslate nohighlight">\(p(y_i | \theta_i)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p(a, b, \theta_1, \ldots, \theta_C, y_1, \ldots, y_C) = p(a)p(b) \prod_{i=1}^C p(\theta_i\mid a, b) p(y_i\mid\theta_i)
\]</div>
<p>Factoring the distribution this way helps us understand and mathematically demonstrate the independence and dependence relationships in our graphical models, as we’ll see shortly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;TzY3-EYwipk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/TzY3-EYwipk"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</section>
<section id="independence-and-conditional-independence">
<h2>Independence and Conditional Independence<a class="headerlink" href="#independence-and-conditional-independence" title="Permalink to this heading">#</a></h2>
<section id="review-independence-and-conditional-independence">
<h3>Review: independence and conditional independence<a class="headerlink" href="#review-independence-and-conditional-independence" title="Permalink to this heading">#</a></h3>
<p>We say that two random variables <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are <strong>independent</strong> if knowing the value of one tells us nothing about the distribution of the other. Notationally, we write <span class="math notranslate nohighlight">\(w \perp\!\!\!\perp v\)</span>. The following statements are all true for independent random variables <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(v\)</span>:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are independent (<span class="math notranslate nohighlight">\(w \perp\!\!\!\perp v\)</span>), then the joint distribution <span class="math notranslate nohighlight">\(p(w, v)\)</span> can be written as the product of the marginal distributions: <span class="math notranslate nohighlight">\(p(w, v) = p(w)p(v)\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are independent (<span class="math notranslate nohighlight">\(w \perp\!\!\!\perp v\)</span>), then the conditional distributions are equal to the marginal distributions: <span class="math notranslate nohighlight">\(p(w|v) = p(w)\)</span> and <span class="math notranslate nohighlight">\(p(v|w) = p(v)\)</span>.</p></li>
</ul>
<p><em><strong>Exercise</strong>: using the definition of conditional distributions, show that the two conditions above are mathematically equivalent.</em></p>
<p>We say that two random variables <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are <strong>conditionally independent</strong> given a third random variable <span class="math notranslate nohighlight">\(u\)</span> if, when we condition on <span class="math notranslate nohighlight">\(u\)</span>, knowing the value of one of <span class="math notranslate nohighlight">\(v\)</span> or <span class="math notranslate nohighlight">\(w\)</span> tells us nothing about the distribution of the other. Notationally, we write <span class="math notranslate nohighlight">\(w \perp\!\!\!\perp v \mid u\)</span>, and mathematically this means that <span class="math notranslate nohighlight">\(p(w, v \mid u) = p(w\mid u) p(v \mid u)\)</span>.</p>
<p>For example, suppose <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are the heights of two people randomly sampled from a very specific population with some average height <span class="math notranslate nohighlight">\(\mu\)</span>. If we know the value of <span class="math notranslate nohighlight">\(\mu\)</span>, then <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are conditionally independent, because they’re random samples. Suppose instead that we don’t know the value of <span class="math notranslate nohighlight">\(\mu\)</span>, but we find out that <span class="math notranslate nohighlight">\(x_1 = 7' 1''\)</span>. In this case, we might guess that the ‘specific population’ is likely a very tall group, such as NBA players. This will affect our belief about the distribution of <span class="math notranslate nohighlight">\(x_2\)</span> (i.e., we should expect the second person to be tall too). So, in this case:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are conditionally independent given <span class="math notranslate nohighlight">\(\mu\)</span>: <span class="math notranslate nohighlight">\(x_1 \perp\!\!\!\perp x_2 \mid \mu\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are not unconditionally independent: it is not true that <span class="math notranslate nohighlight">\(x_1 \perp\!\!\!\perp x_2\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;WhqyUmqkSE8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/WhqyUmqkSE8"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</section>
<section id="independence-and-conditional-independence-in-graphical-models">
<h3>Independence and conditional independence in graphical models<a class="headerlink" href="#independence-and-conditional-independence-in-graphical-models" title="Permalink to this heading">#</a></h3>
<p>The structure of a graphical model can tell us a lot about the independence relationships between the variables in our model. Specifically, we can determine whether two random variables are unconditionally independent or conditionally independent given a third variable, just by looking at the structure of the model. Let’s look at a few examples to illustrate this. We’ll start with the height example we just saw:</p>
<p><img alt="" src="../../../_images/heights_gm.png" /></p>
<p>From our reasoning above, we know that <span class="math notranslate nohighlight">\(x_1 \perp\!\!\!\perp x_2 \mid \mu\)</span>, but that <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are not unconditionally independent. This is true in general for any three variables in a graphical model in this configuration.</p>
<p><em><strong>Exercise</strong>: mathematically prove the results stated above.</em></p>
<p><strong>Solution</strong>: To show that <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are not unconditionally independent, we must show that <span class="math notranslate nohighlight">\(p(x_1, x_2) \neq p(x_1)p(x_2)\)</span>. We can compute <span class="math notranslate nohighlight">\(p(x_1, x_2)\)</span> by looking at the joint distribution over all three variables and then marginalizing over <span class="math notranslate nohighlight">\(\mu\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
p(x_1, x_2) 
&amp;= \int p(x_1, x_2, \mu) d\mu \\
&amp;= \int p(\mu) p(x_1 \mid \mu) p(x_2 \mid \mu) d\mu
\end{align*}
\end{split}\]</div>
<p>Unfortunately, there is no way to factor the integral that separates terms with <span class="math notranslate nohighlight">\(x_1\)</span> and terms with <span class="math notranslate nohighlight">\(x_2\)</span>, so this does not factor. In other words, in general, the integral above will not equal <span class="math notranslate nohighlight">\(p(x_1)p(x_2)\)</span>, so the variables are not unconditionally independent.</p>
<p>What about conditional independence given <span class="math notranslate nohighlight">\(\mu\)</span>? We need to show that <span class="math notranslate nohighlight">\(p(x_1, x_2\mid\mu) = p(x_1\mid\mu) p(x_2\mid\mu)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
p(x_1, x_2 \mid \mu) 
&amp;= \frac{p(x_1, x_2, \mu)}{p(\mu)} \\
&amp;= \frac{p(\mu) p(x_1 \mid \mu) p(x_2 \mid \mu)}{p(\mu)} \\
&amp;= p(x_1 \mid \mu) p(x_2 \mid \mu)
\end{align*}
\end{split}\]</div>
<p>This mathematical result aligns with the intuition we built in the previous section.</p>
<p>Let’s look at another example:</p>
<p><img alt="" src="../../../_images/chain_gm.png" /></p>
<p>In this example, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are not unconditionally independent. Intuitively, we can see that <span class="math notranslate nohighlight">\(y\)</span> depends on <span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> depends on <span class="math notranslate nohighlight">\(y\)</span>, so that <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are dependent.</p>
<p>But, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are conditionally independent given <span class="math notranslate nohighlight">\(y\)</span>: the lack of an arrow directly from <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(z\)</span> tells us that <span class="math notranslate nohighlight">\(z\)</span> only depends on <span class="math notranslate nohighlight">\(x\)</span> through <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p><em><strong>Exercise</strong>: mathematically prove the results stated above.</em></p>
<p>Let’s look at a third example:</p>
<p><img alt="" src="../../../_images/collider_gm.png" /></p>
<p>In this example, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are unconditionally independent, but given <span class="math notranslate nohighlight">\(z\)</span>, they are conditionally dependent. Why? Let’s look at an example that will help us build intuition for this result. Suppose that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y\)</span> is whether or not I have a stuffy nose.</p></li>
<li><p><span class="math notranslate nohighlight">\(x\)</span> is whether or not I am sick (with a cold, flu, COVID, etc.)</p></li>
<li><p><span class="math notranslate nohighlight">\(z\)</span> is whether or not I have seasonal allergies.</p></li>
</ul>
<p>First, we can see that the description matches the graphical model: whether or not I have a stuffy nose depends on whether or not I’m sick, and whether or not I have allergies. But, they don’t affect each other. In other words, if I don’t know anything about whether I have a stuffy nose, then my sickness and allergies are independent of each other.</p>
<p>Now, suppose I wake up one morning with a stuffy nose (i.e., <span class="math notranslate nohighlight">\(y=1\)</span>), and I’m trying to determine whether I’m sick or have allergies. I call my friend who usually has allergies around the same time of the year as me, and my friend tells me that they are having severe allergies right now. As soon as I hear this information, I’m a lot more certain that <span class="math notranslate nohighlight">\(z=1\)</span>. But, even though my friend didn’t tell me anything about whether or not I’m sick, my belief that I’m sick drops significantly: my symptoms have been <strong>explained away</strong> by the explanation that I probably have allergies. In other words, conditioned on a value of <span class="math notranslate nohighlight">\(y\)</span>, knowing something about <span class="math notranslate nohighlight">\(z\)</span> gives me information about the distribution of <span class="math notranslate nohighlight">\(x\)</span>. This is precisely the definition of conditional dependence.</p>
<p><em><strong>Exercise</strong>: mathematically prove the results above.</em></p>
<p>These results can be formalized and generalized in the <strong>d-separation</strong> or <strong>Bayes’ ball</strong> algorithm. While this algorithm is beyond the scope of this textbook, we’ll look at a variant of it in a few chapters when we talk about causality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;lpujKeK90RM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/lpujKeK90RM"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/chapters/02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_hierarchical_models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bayesian Hierarchical Models</p>
      </div>
    </a>
    <a class="right-next"
       href="04_inference_sampling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bayesian Inference and Sampling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-models">Graphical Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-model-for-product-reviews">Graphical model for product reviews</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-model-for-kidney-cancer-death-risk">Graphical model for kidney cancer death risk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-graphical-model-for-exoplanet-model">Example: Graphical Model for Exoplanet Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-graphical-models-to-probability-distributions">Relating graphical models to probability distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independence-and-conditional-independence">Independence and Conditional Independence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-independence-and-conditional-independence">Review: independence and conditional independence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independence-and-conditional-independence-in-graphical-models">Independence and conditional independence in graphical models</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Data 102 Staff
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>